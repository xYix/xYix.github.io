---
title: å­—ç¬¦ä¸²é¢˜é›†
---

<center><a href='/posts/posts/string-tech.html'>ä¸Šå›è¯´åˆ°...</a></center>

# æœ€å°è¡¨ç¤ºæ³•çš„è¿›ä¸€æ­¥è®¨è®º

å¯¹äº $s$ çš„ä¸€ä¸ªåç¼€ $u$ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªä¸² $t$ ä½¿å¾— $ut$ æ˜¯ $st$ çš„æœ€å°åç¼€ï¼Œé‚£ä¹ˆå°±è¯´ $u$ æ˜¯ **Significant** çš„ã€‚

> **å¼•ç† 0.** æœ€å°è¡¨ç¤ºæ³•æ€»æ˜¯ Significant çš„ã€‚

> **è¯æ˜.**
>
> é¦–å…ˆè¯´æ˜ï¼Œå¦‚æœæœ‰å¤šä¸ªæœ€å°è¡¨ç¤ºæ³•æˆ‘ä»¬åªå–å¼€å¤´ä¸‹æ ‡æœ€å°çš„ä¸€ä¸ªã€‚ï¼ˆå¦‚æœæ²¡æœ‰è¿™ä¸ªçº¦å®šå°±å®Œè›‹äº†â€¦â€¦ä¾‹ï¼š``ababab`` ä¸­çš„ ``abab``+``ab`` æ˜¯æœ€å°è¡¨ç¤ºæ³•ä¹‹ä¸€ä½†æ˜¯ ``abab`` å¹¶ä¸ Significantï¼‰
>
> å¯¹äºæœ€å°è¡¨ç¤ºæ³• $s\left[i:\right]s\left[:i-1\right]$ï¼Œæ„é€  $t=s\left[:i-1\right]z^{\infty}$ï¼Œå…¶ä¸­ $z$ æ˜¯å­—ç¬¦é›†ä¸­çš„æœ€å¤§å­—ç¬¦ã€‚ä¸‹é¢è¯´æ˜ $s\left[i:\right]s\left[:i-1\right]$ åœ¨è¿™ä¸ª $t$ ä¸‹å¿…å®šæœ€å°ã€‚
>
> æœªå®Œæ•´å‡ºç°çš„è¡¨ç¤ºæ³•å…¨è¢« $z^{\infty}$ å‘æ­»äº†ï¼›è€Œç”±äº $i$ æ˜¯ä¸‹æ ‡æœ€å°çš„æ‰€ä»¥å®Œæ•´å‡ºç°çš„è¡¨ç¤ºæ³•ä¸­æ²¡æœ‰ç­‰äº $s\left[i:\right]s\left[:i-1\right]$ çš„ï¼›æ‰€ä»¥å‰©ä¸‹çš„è¡¨ç¤ºæ³•éƒ½å¤§äº $s\left[i:\right]s\left[:i-1\right]$ï¼Œè‡ªç„¶ä¹Ÿå°±æ¯”ä¸è¿‡å®ƒã€‚

å¯è§ Significant Suffix å¯¹æœ€å°è¡¨ç¤ºæ³•é—®é¢˜çš„é‡è¦æ€§ã€‚

ç„¶åæˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸ªåç¼€ Significant çš„æ¡ä»¶ã€‚åç¼€çš„å¼€å¤´éå¸¸é‡è¦ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸‹é¢ç”¨å®ƒçš„å¼€å¤´æ¥ä»£è¡¨è¿™ä¸ªåç¼€ã€‚è€ƒè™‘åŸä¸²çš„ Lyndon åˆ†è§£ $w_1^{k_1}w_2^{k_2}...w_m^{k_m}$ã€‚ä¸€ä¸ªåç¼€å¦‚æœ Significantï¼Œé‚£ä¹ˆå®ƒå°±å¿…é¡»æ˜¯å…¶ä¸­æŸä¸ª Lyndon Word çš„å¼€å¤´ã€‚å¦åˆ™æ˜¾ç„¶å®ƒä¸€å®šæ¯”ä¸è¿‡åè€…ã€‚

æ›´è¿‘ä¸€æ­¥ï¼Œå®ƒè¿˜å¿…é¡»æ˜¯ $w_i^{k_i}$ çš„å¼€å¤´ã€‚å¦åˆ™ï¼Œæˆ‘ä»¬æ¥è¯´æ˜ $w_i^{k_i}$ çš„å¼€å¤´å’Œ $w_{i+1}^{k_{i+1}}$ çš„å¼€å¤´å¿…æœ‰å…¶ä¸€æ¯”å®ƒå¤§ã€‚åªéœ€è¦è¯æ˜ä»¥ä¸‹å¼•ç†ã€‚

> **å¼•ç† 1.**
>
> å¯¹äºä»»æ„æ»¡è¶³ $u^{\infty}<v$ çš„ä¸² $u,v$ï¼Œ$v>uv>u^2v>\ldots$ã€‚

> **è¯æ˜.**
>
> ç”±äº $u^{\infty}<v$ ç­‰ä»·äº $u^{\infty}<uv$ï¼Œæˆ‘ä»¬åªéœ€è¦è¯æ˜ $uv<v$ã€‚
>
> ä»¤ $v=u^kv'$ï¼ŒåŸºäºåŒæ ·çš„ç†ç”±æˆ‘ä»¬åªéœ€è¦è¯æ˜ $k=0$ çš„æƒ…å†µã€‚
>
> æ­¤æ—¶å¿…ç„¶æœ‰ $u\triangleleft v$ã€‚è¿™å°±å¾—è¯äº†ã€‚

äºæ˜¯è®° $s_i=w_{i}^{k_i}w_{i+1}^{k_{i+1}}...$ï¼Œä¸Šé¢çš„è®ºè¿°å°±æ˜¯è¯æ˜äº†

> **å®šç† 1. (Significant Suffixes Theorem)**
>
> Significant Suffix å¿…é¡»æ˜¯ $s_i$ ä¹‹ä¸€ã€‚

ä¸‹é¢æ˜¯å¯¹ Significant Suffix çš„æ›´è‹›åˆ»è¦æ±‚ã€‚

> **å¼•ç† 2.**
>
> å¯¹äº Significant Suffix $u,v$ï¼Œå¦‚æœ $|u|<|v|$ï¼Œåˆ™å¿…æœ‰ $u$ æ—¢æ˜¯ $v$ çš„å‰ç¼€ä¹Ÿæ˜¯å…¶åç¼€ï¼Œä¸” $2|u|\le|v|$ã€‚
>
> ï¼ˆæ³¨æ„è¿™ç«‹åˆ»å¾—å‡º Significant Suffix çš„æ•°é‡ä¸º $O(\log n)$ã€‚ï¼‰

> **è¯æ˜.**
>
> $u$ æ˜¾ç„¶æ˜¯ $v$ çš„åç¼€ã€‚
>
> $u$ å¿…é¡»æ˜¯ $v$ çš„å‰ç¼€ï¼Œå¦åˆ™ $u,v$ ä¸­è¾ƒå¤§çš„ä¸€è€…ä¸€å®šä¸ Significantã€‚
>
> å¦‚æœ $2|u|>|v|$ï¼Œæƒ³è±¡ä¸€ä¸ªåœ¨å‰ä¸€ä¸ªåœ¨åçš„ä¸¤ä¸ª $u$ã€‚ä¸¤ä¸ª $u$ æœ‰é‡å ï¼Œè¯´æ˜ $u$ å‰é¢ä¸€æ®µå’Œåé¢ä¸€æ®µç›¸ç­‰ï¼Œè€Œè¿™ä¸€ç›¸ç­‰æ€§ä¼šå› ä¸ºä¸¤ä¸ª $u$ ä¸€æ ·è€Œç«‹åˆ»ä¼ æ’­å¼€å»ã€‚
>
> æ€»ä¹‹å¯ä»¥æ¨å‡º $v$ åˆä¸€ä¸ªé•¿åº¦ä¸º $|v|-|u|$ çš„å‘¨æœŸã€‚äºæ˜¯è®¾ $u=Tu',v=T^2u'$ã€‚
>
> ç”±äº $u$ Significantï¼Œé‚£ä¹ˆå¿…å®šå­˜åœ¨ $t$ ä½¿å¾— $ut$ æœ€å°ï¼Œé‚£å°±æœ‰ $vt>ut$ï¼Œä½†è¿™ç«‹å³ä¹Ÿæ¨å‡º $ut>u't$ï¼Œä»è€Œ $u$ ä¸å¯èƒ½ Significantï¼ŒçŸ›ç›¾ã€‚

åˆæ˜¯ä¸€ä¸ªå¾ˆå¼ºçš„ç»“è®ºï¼Œä½†æ˜¯æ³¨æ„å®ƒçš„ä½¿ç”¨é™åˆ¶ä¹Ÿå¹¶ä¸éå¸¸æ¾ï¼šè‡³å°‘å¾—ç¡®å®šç¬¬ä¸€ä¸ª Significant Suffix å§ã€‚

ä¸ºäº†å¼•å‡ºæ›´æ›´è¿›ä¸€æ­¥çš„ç»“è®ºï¼Œæˆ‘ä»¬æ¥è€ƒè™‘ä¸‹é¢è¿™ä¸ªå…·ä½“é—®é¢˜ã€‚

> **é¢˜ç›®å¤§æ„. (ã€ZJOI2017ã€‘å­—ç¬¦ä¸²)**
>
> ç»´æŠ¤ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå­—ç¬¦é›†ä¸ºæ‰€æœ‰æ•´æ•°ï¼Œè¦æ±‚æ”¯æŒ
>
> - åŒºé—´åŠ ï¼›
> - è¯¢é—® $s\left[l:r\right]$ çš„æœ€å°åç¼€ã€‚
>
> $|s|\le2\times10^5,q\le3\times10^4$ã€‚
>
> æ—¶é™ $3s$ã€‚

é¦–å…ˆå¦‚æœä¸å¸¦ä¿®ï¼Œè€ƒè™‘ä½¿ç”¨çº¿æ®µæ ‘å¤§åŠ›ç»´æŠ¤æŸåŒºé—´çš„ Significant Suffixesã€‚ä½†æ˜¯æˆ‘ä»¬å¯¹ Significant Suffix çš„è®¤è¯†æ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ï¼Œæ‰€ä»¥è€ƒè™‘è®°å½•â€œAlmost Significant Suffixesâ€ï¼Œç®€ç§° ASSï¼Œå…è®¸ä¸€äº›ä¸ Significant çš„åç¼€å‡ºç°åœ¨å…¶ä¸­ï¼Œä½†ä»è¦ä¿è¯å…¶ä¸­çš„ä¸²ä¸¤ä¸¤æœ‰å‰ç¼€å…³ç³»ï¼Œä¸”é•¿åº¦ç›¸å·®ä¸¤å€ã€‚

ä¸‹é¢å…³æ³¨äºåˆå¹¶ã€‚

æ‰€æœ‰å³åŒºé—´çš„ ASS è‡ªç„¶ä»ç„¶æ˜¯ ASSã€‚ä»ååˆ°å‰ä¾æ¬¡è€ƒè™‘å·¦åŒºé—´çš„ ASSï¼Œè®¾å½“å‰åŠ å…¥çš„ä¸º $u$ï¼Œå³åŒºé—´ ASS çš„æœ€é•¿è€…ä¸º $v$ï¼š

- å¦‚æœ $v<u\left[:|v|-1\right]$ï¼Œé‚£ä¹ˆ $l$ ä¸€å®šä¸ Significantï¼Œå¯ä»¥æ’é™¤ã€‚
- å¦‚æœ $v>u\left[:|v|-1\right]$ï¼Œé‚£ä¹ˆ $v$ ä¸€å®šä¸ Significantï¼Œæ’é™¤ã€‚$l$ åˆ™ç»§ç»­æ’å…¥ã€‚
- å¦åˆ™ $v=u\left[:|v|-1\right]$ï¼Œå¯è§çš„æ˜¯ä»»ä½•çŸ­äº $v$ çš„ ASS ä¹Ÿæ˜¯ $u$ çš„å‰ç¼€ï¼Œé‚£ä¹ˆä¸‹é¢çœ‹é•¿åº¦ã€‚
- - å¦‚æœ $|u|<2|v|$ã€‚å¿…é¡»æ³¨æ„ï¼Œä¸ç®¡ $u$ æ˜¯å¦ Significantï¼Œ$v$ æœ‰ä¸¤æ¬¡ç›¸äº’é‡å çš„å‡ºç°å·²ç»æ˜¯äº‹å®äº†ï¼Œå³ $v$ å¿…ä¸ Significantã€‚åˆ é™¤ä¹‹ï¼Œç›´æ¥æŠŠ $u$ ç½®å…¥ã€‚

è€ƒè™‘æ”¯æŒä¿®æ”¹ï¼Œæˆ‘ä»¬çš„ç­–ç•¥æ˜¯ï¼š

- åˆ†å—ç»´æŠ¤å“ˆå¸Œå€¼æ¥æ”¯æŒå­—ç¬¦ä¸²æ¯”è¾ƒã€‚
- å¦‚æœåŒºé—´è¢«å®Œæ•´ä¿®æ”¹ï¼Œé‚£ä¹ˆ ASS ä¸å˜ï¼›ä½†æ˜¯è¦ä¸€è·¯ pushup ä¸Šå»ã€‚

é¡ºå¸¦ä¸€æï¼Œè¿™é¢˜æ•°æ®æ°´å¾—ä»¤äººå‘æŒ‡â€¦â€¦ä¸‹é¢è¿™ä¸ªå­—ç¬¦ä¸²æš´åŠ›æ¯”è¾ƒçš„é¬¼æš´åŠ›éƒ½èƒ½è¿‡åŸé¢˜æ•°æ®ã€‚

```cpp
int cmp(int *p1, int *p2, int len) {
	while (len) {
		if (*p1 != *p2) return *p1 - *p2;
		len--; p1++; p2++;
	}
	return 0;
}
struct node {
	int l, r;
	vector<int> lis;
} T[maxn << 2];
void merge(const node &nL, const node &nR, node &ans) {
	ans.lis = nR.lis;
	for (int v : nL.lis) {
		while (ans.lis.size()) {
			int u = ans.lis[ans.lis.size() - 1];
			int flg = cmp(s + u, s + v, nR.r + 1 - u);
			if (flg < 0) goto qaq;
			if (flg == 0) {
				if (2 * (nR.r + 1 - u) > nR.r + 1 - v) ans.lis.pop_back();
				ans.lis.push_back(v);
				goto qaq;
			}
			ans.lis.pop_back();
		}
		ans.lis.push_back(v);
		qaq:;
	}
}
```

å¦ä¸€ä¸ªæœ‰é‡è¦å¯å‘çš„é¢˜ç›®ã€‚

> **é¢˜ç›®å¤§æ„. ([JSOI2019]èŠ‚æ—¥åº†å…¸)**
>
> æ±‚ $s$ çš„æ¯ä¸€ä¸ªå‰ç¼€çš„æœ€å°è¡¨ç¤ºæ³•ã€‚
>
> $|s|\le3\text{e}6$ã€‚

ç”±ä¹‹å‰çš„è®¨è®ºæ˜¾ç„¶æœ‰ $O(n\log n)$ çš„åšæ³•ã€‚æ³¨æ„åˆ°æœ€ç»ˆæ¯”è¾ƒå„è¡¨ç¤ºæ³•æ—¶å¯ä»¥è½¬åŒ–ä¸ºä¸€ä¸ªåç¼€ä¸åŸä¸²çš„æ¯”è¾ƒï¼Œè¿™æ­£æ˜¯ Z å‡½æ•°ã€‚è¿™ä¸ªè§‚å¯Ÿå¤§å¤§å‡å°äº†è¯¥ç®—æ³•çš„å¸¸æ•°ï¼Œå·²ç»å¯ä»¥é€šè¿‡ã€‚

```cpp
#include<bits/stdc++.h>
using namespace std;

char s[3000005];
int z[3000005];

void getz(char S[], int n) {
	z[1] = n;
	for(int i = 2, j = 1, r = 1; i <= n; i++) {
		if(i <= r) z[i] = min(r - i + 1, z[i - j + 1]);
		else z[i] = 0;
		while(i + z[i] <= n && S[z[i] + 1] == S[i + z[i]]) z[i]++;
		if(i + z[i] - 1 > r) j = i, r = i + z[i] - 1;
	}
}

vector<int> lis;

int main() {
//	freopen("4.in", "r", stdin);
//	freopen("WA.out", "w", stdout);
	scanf("%s", s + 1);
	int n = strlen(s + 1);
	getz(s, n);
	
	lis.push_back(1); printf("%d ", 1);
	for (int i = 2; i <= n; i++) {
		vector<int> nlis; nlis.push_back(i);
		for (int v : lis) {
			while (nlis.size()) {
				int u = nlis.back();
				int flg = s[v + i - u] - s[i];
				if (flg > 0) goto qaq;
				if (flg == 0) {
					if (2 * (i + 1 - u) > i + 1 - v) nlis.pop_back();
					nlis.push_back(v);
					goto qaq;
				}
				nlis.pop_back();
			}
			nlis.push_back(v);
			qaq:;
		}
		lis = nlis;
		int v = nlis[0];
		for (int u : nlis) {
			int p = i - v + u + 1;
			if (p + z[p] <= i)	{
				if (s[p + z[p]] <= s[1 + z[p]]) v = u;
			}
			else {
				p = i - p + 2;
				int len = min(z[p], v - 1 - p);
				if (s[1 + len] <= s[p + len]) v = u;
			}
		}
		printf("%d ", v);
	}
}
```

ç„¶è€Œè¿˜å¯ä»¥ç»§ç»­è€ƒè™‘çº¿æ€§ç®—æ³•ã€‚ï¼ˆğŸ•Šï¼‰

# æœ¬åŸå¹³æ–¹ä¸²

ä¸€ä¸ª**æœ¬åŸå¹³æ–¹ä¸²**

